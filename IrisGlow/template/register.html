{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js">
    <link rel="stylesheet" href="{% static 'style.css' %}">
    <title>Register</title>
    <style>
      body{
        background-image: url('{% static '/img/bulding.jpg' %}'); /* Replace with the path to your background image */
        background-position: center;
        background-size: cover;
    }

    .alert-top {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      max-width: 500px;
      z-index: 1000;
  }
    </style>
</head>
<body>
    <div class="container d-flex justify-content-right align-items-center min-vh-100">
        <div class="row border rounded-5 p-3 bg-white shadow box-area">
          <div class="col-md-6 rounded-4 d-flex justify-content-center align-items-center flex-column left-box" style="background: #103cbe;">
            <div class="featured-image mb-3">
            </div>
            <img src="{% static '/img/safety_8399977.png' %}" class="img-fluid" style="width: 250px;">
            <p class="text-white fs-2" style="font-family: 'Gill Sans', Andale Mono, monospace; font-weight: 600;">IrisGlow</p>
            <small class="text-white text-wrap text-center" style="width: 17rem;font-family: 'Courier New', Courier, monospace;">Caring for Your Eyes Starts Here!</small>
        </div> 
            <div class="col-md-6 right-box">
                <div class="row align-items-center">
                    <form method="POST">
                        {% csrf_token %}
                        <div class="header-text mb-4">
                            <h2>Create an Account</h2>
                            <p>Get started by filling out the form below.</p>
                        </div>
                        <div class="input-group mb-3">
                            <input type="text" class="form-control form-control-lg bg-light fs-6" onkeyup="validateFirst_Name()" placeholder="First Name" id="first_name" name="first_name" required><br>
                            <div class="invalid-feedback"></div>
                            <div class="valid-feedback"></div>
                        </div>

                        <div class="input-group mb-3">
                          <input type="text" class="form-control form-control-lg bg-light fs-6" onkeyup="validateLast_Name()" placeholder="Last Name" id="last_name" name="last_name" required><br>
                          <div class="invalid-feedback"></div>
                          <div class="valid-feedback"></div>
                      </div>

                        <div class="input-group mb-3">
                          <input type="text" class="form-control form-control-lg bg-light fs-6" onkeyup="validateUser_Name()" placeholder="Username" id="username" name="username" required><br>
                          <div class="invalid-feedback"></div>
                          <div class="valid-feedback"></div>
                      </div>

                        <div class="input-group mb-3">
                            <input type="text" class="form-control form-control-lg bg-light fs-6" onkeyup="validateEmail()" placeholder="Email Address" id="email" name="email" required><br>
                            <div class="invalid-feedback"></div>
                            <div class="valid-feedback"></div>
                        </div>
                        <div class="input-group mb-3">
                            <input type="text" class="form-control form-control-lg bg-light fs-6" onkeyup="validatePhoneNumber()" placeholder="Phone no" id="phone" name="phone" required><br>
                            <div class="invalid-feedback"></div>
                            <div class="valid-feedback"></div>
                        </div>
                        <div class="input-group mb-3">
                            <input type="password" class="form-control form-control-lg bg-light fs-6" onkeyup="validatePassword()" placeholder="Password" id="password" name="password" required><br>
                            <span id="pw" class="text-danger"></span>
                            <div class="invalid-feedback"></div>
                            <div class="valid-feedback"></div>
                        </div>
                        <div class="input-group mb-3">
                            <input type="password" class="form-control form-control-lg bg-light fs-6" onkeyup="validateConfirmPassword()" placeholder="Confirm Password" id="confirmPassword" name="confirmPassword" required><br>
                            <div class="invalid-feedback"></div>
                            <div class="valid-feedback"></div>
                        </div>
                        <div class="input-group mb-3">
                            <button class="btn btn-lg btn-primary w-100 fs-6" type="submit" onclick="return checkall()" >Register</button>
                        </div>
                    </form>
                    <div class="row">
                        <small>Already have an account? <a href="login/">Login</a></small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const first_nameInput = document.getElementById('first_name');
        const last_nameInput = document.getElementById('last_name');
        const usernameInput = document.getElementById('username');
        const emailInput = document.getElementById('email');
        const phoneInput = document.getElementById('phone');
        const passwordInput = document.getElementById('password');
        const confirmPasswordInput = document.getElementById('confirmPassword');
  
        first_nameInput.addEventListener('blur', function(event) { validateFirst_Name(); });
        last_nameInput.addEventListener('blur', function(event) { validateLast_Name(); });
        usernameInput.addEventListener('blur', function(event) { validateUser_Name(); });
        emailInput.addEventListener('blur', function(event) { validateEmail(); });
        phoneInput.addEventListener('blur', function(event) { validatePhoneNumber(); });
        passwordInput.addEventListener('blur', function(event) { validatePassword(); });
        confirmPasswordInput.addEventListener('blur', function(event) { validateConfirmPassword(); });


        function validateFirst_Name() {
          const namePattern = /^[A-Za-z]+$/;
          if (!namePattern.test(first_nameInput.value)) {
            first_nameInput.classList.add('is-invalid');
            first_nameInput.classList.remove('is-valid');
            return false;
          } else {
            first_nameInput.classList.remove('is-invalid');
            first_nameInput.classList.add('is-valid');
            return true;
          }
        }

        function validateLast_Name() {
          const namePattern = /^[A-Za-z]+$/;
          if (!namePattern.test(last_nameInput.value)) {
            last_nameInput.classList.add('is-invalid');
            last_nameInput.classList.remove('is-valid');
            return false;
          } else {
            last_nameInput.classList.remove('is-invalid');
            last_nameInput.classList.add('is-valid');
            return true;
          }
        }

        function validateUser_Name() {
          const namePattern = /^[A-Za-z0-9!@#$%^&*()_+{}\[\]:;<>,.?~\/\-\\]+$/;
          if (!namePattern.test(usernameInput.value)) {
            usernameInput.classList.add('is-invalid');
            usernameInput.classList.remove('is-valid');
            return false;
          } else {
            usernameInput.classList.remove('is-invalid');
            usernameInput.classList.add('is-valid');
            return true;
          }
        }

        function validateEmail() {
          const emailPattern = /^[a-zA-Z0-9._%+-]+@(gmail\.com|[a-zA-Z0-9.-]+\.(com|in))$/;
          if (!emailPattern.test(emailInput.value)) {
            emailInput.classList.add('is-invalid');
            emailInput.classList.remove('is-valid');
            return false;
          } else {
            emailInput.classList.remove('is-invalid');
            emailInput.classList.add('is-valid');
            return true;
          }
        }

        function validatePhoneNumber() {
          const phoneNumberPattern =/^(?!.*0000)[6-9][0-9]{9}$/;
          if (!phoneNumberPattern.test(phoneInput.value)) {
            phoneInput.classList.add('is-invalid');
            phoneInput.classList.remove('is-valid');
            return false;
          } else {
            phoneInput.classList.remove('is-invalid');
            phoneInput.classList.add('is-valid');
            return true;
          }
        }

        function validatePassword() {
          const passwordPattern = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*()_+[\]{}|;:'",.<>?/~`]).{8,}$/;
          if (!passwordPattern.test(passwordInput.value)) {
            passwordInput.classList.add('is-invalid');
            passwordInput.classList.remove('is-valid');
            return false;
          } else {
            passwordInput.classList.remove('is-invalid');
            passwordInput.classList.add('is-valid');
            return true;
          }
        }

        function validateConfirmPassword() {
          if (passwordInput.value !== confirmPasswordInput.value) {
            confirmPasswordInput.classList.add('is-invalid');
            confirmPasswordInput.classList.remove('is-valid');
            return false;
          } else {
            confirmPasswordInput.classList.remove('is-invalid');
            confirmPasswordInput.classList.add('is-valid');
            return true;
          }
        }

        function checkall() {
          if (validateFirst_Name() && validateLast_Name() && validateUser_Name() && validateEmail() && validatePassword() && validateConfirmPassword() && validatePhoneNumber()) {
            return true;
          }
          return false;
        }

        const urlParams = new URLSearchParams(window.location.search);
        const alertType = urlParams.get('alert');
  
        if (alertType === 'username_is_already_registered') {
            showAlert('Username is already registered', 'danger');
        } else if (alertType === 'email_is_already_registered') {
            showAlert('Email is already registered', 'danger');
        } else if (alertType === 'registered') {
            showAlert('Registered', 'success');
        }
  
        function showAlert(message, alertType) {
            const alertDiv = document.createElement('div');
            alertDiv.classList.add('alert', `alert-${alertType}`, 'alert-top');
            alertDiv.textContent = message;
  
            const container = document.querySelector('.container');
            container.insertBefore(alertDiv, container.firstChild);
  
            setTimeout(function() {
                alertDiv.remove();
            }, 5000);  // Remove after 5 seconds
        }
      });


  
      </script>
</body>
</html>
