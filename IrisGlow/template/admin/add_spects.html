{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <title>Register</title>
    <style>
      body{
        background-image: url('{% static '/img/.jpg' %}'); /* Replace with the path to your background image */
        background-position: center;
        background-size: cover;
    }

    .alert-top {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      max-width: 500px;
      z-index: 1000;
  }

  
    </style>
</head>
<body>
    <div class="container d-flex justify-content-right align-items-center min-vh-100">
        <div class="row border rounded-5 p-3 bg-white shadow box-area">
          <div class="col-md-6 rounded-4 d-flex justify-content-center align-items-center flex-column left-box" style="background: #103cbe;">
            <div class="featured-image mb-3">
            </div>
            <img src="{% static '/img/logo1.png' %}" class="img-fluid" style="width: 250px;">
            <p class="text-white fs-2" style="font-family: 'Open Sans', Andale Mono, normal; font-weight: 600;">IrisGlow</p>
            <small class="text-white text-wrap text-center" style="width: 17rem;font-family: 'Open Sans', monospace;">Caring for Your Eyes Starts Here!</small>
        </div> 
            <div class="col-md-6 right-box">
                <div class="row align-items-center">
                    <form method="POST">
                        {% csrf_token %}
                        <div class="header-text mb-4">
                            <h2>Create an Account</h2>
                            <p>Get started by filling out the form below.</p>
                        </div>
                        <div class="input-group mb-3">
                          <input type="text" class="form-control form-control-lg bg-light fs-6" onkeyup="validateFirst_Name()" placeholder="First Name" id="first_name" name="first_name" required><br>
                          <div class="invalid-feedback" id="fnamevalid">Numbers and special characters are not allowed</div>
                          <div class="valid-feedback" id="fnvalid"></div>
                        </div> 

                        <div class="input-group mb-3">
                          <input type="text" class="form-control form-control-lg bg-light fs-6" onkeyup="validateLast_Name()" placeholder="Last Name" id="last_name" name="last_name" required><br>
                          <div class="invalid-feedback" id="lnamevalid">Numbers and special characters are not allowed</div>
                          <div class="valid-feedback" id="lnvalid"></div>
                        </div> 


                      {% comment %} <div class="input-group mb-3">
                        <input type="text" class="form-control form-control-lg bg-light fs-6" onkeyup="validateUser_Name()" placeholder="Username" id="username" name="username" required><br>
                        <div class="invalid-feedback"></div>
                        <div class="valid-feedback"></div>
                    </div> {% endcomment %}


                        

                        {% comment %} <div class="input-group mb-3">
                            <input type="text" class="form-control form-control-lg bg-light fs-6" onkeyup="validateEmail()" placeholder="Email Address" id="email" name="email" required><br>
                            <div class="invalid-feedback"></div>
                            <div class="valid-feedback"></div>
                        </div> {% endcomment %}
                        <div class="form-container">
                        <div class="input-group mb-3">
                          <input type="text" class="form-control form-control-lg bg-light fs-6" onkeyup="validateEmail()" placeholder="Email Address" id="email" name="email" required><br>
                          <div class="invalid-feedback" id="emailInvalid">Invalid email address</div>
                          <div class="valid-feedback" id="emailValid"></div>
                      </div


                      <div class="input-group mb-3">
                        <input type="text" class="form-control form-control-lg bg-light fs-6" onkeyup="validatePhoneNumber()" placeholder="Phone no" id="phone" name="phone" required><br>
                        <div class="invalid-feedback" id="phoneInvalid">Invalid phone number</div>
                        <div class="valid-feedback" id="phoneValid"></div>
                    </div>
                    
                        <div class="input-group mb-3">
                          <input type="password" class="form-control form-control-lg bg-light fs-6" onkeyup="validatePassword()" placeholder="Password" id="password" name="password" ><br>
                          <span id="pw" class="text-danger"></span>
                         
                          <div id="passValidation" class="invalid-feedback">
                            Password must be at least 8 characters long and contain at least one
                            uppercase
                            letter, one lowercase letter, one number, and one special character.
                        </div>
                        <div id="passValid" class="valid-feedback">
                            Looks good!
                        </div>
                      </div>


                      <div class="input-group mb-3">
                        <input type="password" class="form-control form-control-lg bg-light fs-6" onkeyup="validateConfirmPassword()" placeholder="Confirm Password" id="confirmPassword" name="confirmPassword" required><br>
                    
                        <div id="confirmValidation" class="invalid-feedback">
                            Passwords do not match.
                        </div>
                        <div id="cpassValid" class="valid-feedback">
                            Passwords match!
                        </div>
                    </div>
                      
                        

                        
                        {% comment %} <div class="input-group mb-3">
                            <input type="password" class="form-control form-control-lg bg-light fs-6" onkeyup="validateConfirmPassword()" placeholder="Confirm Password" id="confirmPassword" name="confirmPassword" required><br>
                            
                            
                            <div class="invalid-feedback"></div>
                            <div class="valid-feedback"></div>
                        </div> {% endcomment %}
                        <div class="input-group mb-3">
                            <button class="btn btn-lg btn-primary w-100 fs-6" type="submit" onclick="return checkall()" >Register</button>
                        </div>
                    </form>
                    <div class="row">
                        <small><b>Already have an account?</b> <button><a href="{% url "login" %}"><b>Login</b></a></button></small>
                    </div>

                    {% comment %} <div class="input-group mb-3">
                      <button class="btn btn-lg btn-primary w-100 fs-6">
                        <a href="{% url "social:begin" "google-oauth2" %}"><b>Login with Google</b></a>
                      </button>
                      </div> {% endcomment %}



                </div>
            </div>
        </div>
    </div>




    
    
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const first_nameInput = document.getElementById('first_name');
        const last_nameInput = document.getElementById('last_name');
        {% comment %} const usernameInput = document.getElementById('username'); {% endcomment %}
        const emailInput = document.getElementById('email');
        const phoneInput = document.getElementById('phone');
        const passwordInput = document.getElementById('password');
        const confirmPasswordInput = document.getElementById('confirmPassword');
  
        first_nameInput.addEventListener('keyup', function(event) { validateFirst_Name(); });
        last_nameInput.addEventListener('keyup', function(event) { validateLast_Name(); });
       
        emailInput.addEventListener('keyup', function(event) { validateEmail(); });
        phoneInput.addEventListener('keyup', function(event) { validatePhoneNumber(); });
        passwordInput.addEventListener('keyup', function(event) { validatePassword(); });
        confirmPasswordInput.addEventListener('keyup', function(event) { validateConfirmPassword(); });


        function validateFirst_Name() {
          const namePattern = /^[A-Za-z]+$/;
          if (!namePattern.test(first_nameInput.value)) {
            first_nameInput.classList.add('is-invalid');
            first_nameInput.classList.remove('is-valid');
            return false;
          } else {
            first_nameInput.classList.remove('is-invalid');
            first_nameInput.classList.add('is-valid');
            return true;
          }
        }


        function validateLast_Name() {
          const namePattern = /^[A-Za-z]+$/;
          if (!namePattern.test(last_nameInput.value)) {
            last_nameInput.classList.add('is-invalid');
            last_nameInput.classList.remove('is-valid');
            return false;
          } else {
            last_nameInput.classList.remove('is-invalid');
            last_nameInput.classList.add('is-valid');
            return true;
          }
        }

        

        


       

        function isValidEmail(email) {
          const validProviders = [
              "gmail", "yahoo", "outlook", "hotmail", "aol", "icloud", "protonmail", "zoho"
              
          ];
      
          const validTLDs = [
              "com", "org", "net", "edu", "gov", "mil", "co", "info", "io", "uk", "in"
              
          ];
      
          const emailParts = email.split("@");
          if (emailParts.length !== 2) {
              return false; 
          }
      
          const provider = emailParts[1].split(".")[0].toLowerCase();
          const tlds = emailParts[1].split(".").slice(1).map(tld => tld.toLowerCase());
      
          const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+$/;
      
         
          if (tlds.some(tld => tld.includes("..")) || tlds.length > 1) {
              return false;
          }
      
         
          if (!validTLDs.includes(tlds[0]) || tlds.indexOf(tlds[0]) !== tlds.lastIndexOf(tlds[0])) {
              return false;
          }
      
          return (
              emailRegex.test(email) &&
              validProviders.includes(provider)
              );
          }
      
      function validateEmail() {
          const emailInput = document.getElementById('email');
          if (!isValidEmail(emailInput.value)) {
              emailInput.classList.add('is-invalid');
              emailInput.classList.remove('is-valid');
              return false;
          } else {
              emailInput.classList.remove('is-invalid');
              emailInput.classList.add('is-valid');
              return true;
          }
      }


      function validatePhoneNumber() {
        const phoneNumberPattern = /^(?!.*0{10})[6-9][0-9]{9}$/;
         if (!phoneNumberPattern.test(phoneInput.value)) {
         phoneInput.classList.add('is-invalid');
         phoneInput.classList.remove('is-valid');
         return false;
         } else {
         phoneInput.classList.remove('is-invalid');
         phoneInput.classList.add('is-valid');
         return true;
         }
       }
  

       function validatePassword() {
        const passwordPattern = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*()_+[\]{}|;:'",.<>?/~`]).{8,}$/;
        const passValidation = document.getElementById('passValidation');
        const passValid = document.getElementById('passValid');

        if (!passwordPattern.test(passwordInput.value)) {
            passwordInput.classList.add('is-invalid');
            passwordInput.classList.remove('is-valid');
            passValidation.style.display = 'block';
            passValid.style.display = 'none';
        } else {
            passwordInput.classList.remove('is-invalid');
            passwordInput.classList.add('is-valid');
            passValidation.style.display = 'none';
            passValid.style.display = 'block';
        }
    }

    function validateConfirmPassword() {
        const confirmPasswordValidation = document.getElementById('cpassValidation');
        const confirmPasswordValid = document.getElementById('cpassValid');

        if (passwordInput.value !== confirmPasswordInput.value) {
            confirmPasswordInput.classList.add('is-invalid');
            confirmPasswordInput.classList.remove('is-valid');
            confirmPasswordValidation.style.display = 'block';
            confirmPasswordValid.style.display = 'none';
        } else {
            confirmPasswordInput.classList.remove('is-invalid');
            confirmPasswordInput.classList.add('is-valid');
            confirmPasswordValidation.style.display = 'none';
            confirmPasswordValid.style.display = 'block';
        }
    }

    

       
        function checkall() {
          if (validateFirst_Name() && validateLast_Name() && validateUser_Name() && validateEmail() && validatePassword() && validateConfirmPassword() && validatePhoneNumber()) {
            return true;
          }
          return false;
        }

        const urlParams = new URLSearchParams(window.location.search);
        const alertType = urlParams.get('alert');
  
        if (alertType === 'username_is_already_registered') {
          showAlert('Username is already registered', 'danger');
      } else if (alertType === 'email_is_already_registered') {
          showAlert('Email is already registered', 'danger');
      } else if (alertType === 'phone_no_is_already_registered') {
          showAlert('Phone number is already registered.', 'danger');
      }else if (alertType === 'passwords_do_not_match') {
        showAlert('Password And Conform Password Not Matching', 'danger');
      }else if (alertType === 'registered') {
        showAlert('Registered', 'success');
    }
  
        function showAlert(message, alertType) {
            const alertDiv = document.createElement('div');
            alertDiv.classList.add('alert', `alert-${alertType}`, 'alert-top');
            alertDiv.textContent = message;
  
            const container = document.querySelector('.container');
            container.insertBefore(alertDiv, container.firstChild);
  
            setTimeout(function() {
                alertDiv.remove();
            }, 5000);  // Remove after 5 seconds
        }
      });


  
      </script>
</body>
</html>
